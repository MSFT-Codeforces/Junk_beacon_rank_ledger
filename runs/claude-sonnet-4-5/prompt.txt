
You are an expert competitive programmer. 
You will be provided with a problem statement, first analyze the problem, then provide your solution in Python. 
Consider edge cases, time complexity, and space complexity. 
Make sure your solution handles all constraints mentioned in the problem. 
Your final solution should be a complete, compilable Python program in a python codeblock.

**Beacon Rank Ledger**

You are given a connected graph with $n$ vertices (beacons) and $m$ edges (paths). You must assign each beacon a distinct activation rank from $1$ to $n$ (i.e., $\text{rank}$ must be a permutation of $1,2,\dots,n$).

Each path is described by three integers $(u, v, w)$ and imposes the exact constraint

$$
\text{rank}[v] - \text{rank}[u] = w.
$$

Note that the physical path is undirected, but the equation direction is fixed as written.

Determine whether such an assignment exists. If it exists, output the ranks for all beacons; otherwise output `-1`.

It can be shown that if a valid assignment exists, it is unique.

**Input Format:-**

The first line contains two integers $n, m$.

The next $m$ lines each contain three integers $u, v, w$ meaning:

$$
\text{rank}[v] - \text{rank}[u] = w.
$$

**Output Format:-**

If no valid assignment exists, print `-1`.

Otherwise, print $n$ integers: $\text{rank}[1]\ \text{rank}[2]\ \dots\ \text{rank}[n]$.

**Constraints:-**

- $2 \le n \le 2 \cdot 10^5$
- $n - 1 \le m \le 2 \cdot 10^5$
- $1 \le u, v \le n$
- $-10^9 \le w \le 10^9$
- The given graph is connected.

**Examples:-**
 - **Input:**
```
4 3
1 2 1
2 3 1
3 4 1
```

 - **Output:**
```
1 2 3 4
```

 - **Input:**
```
3 3
1 2 1
2 3 1
1 3 1
```

 - **Output:**
```
-1
```

 - **Input:**
```
3 2
1 2 2
2 3 2
```

 - **Output:**
```
-1
```